# VRChatからURLを開くシステム
## これは何？
VRChat内でのトリガーで、既定のブラウザからWEBページを開くことを想定したアプリです。  
VRChatの対応ワールドでスイッチなどを押すと、クリック音がしてブラウザでWebページが開きます。

## 動作説明
※この章に記載されている内容は、VRChatワールド作者向けです。

開きたいURLを引数にした起動用URLを、VRChat内からHTTP GETします。

```
http://localhost/Temporary_Listen_Addresses/openURL/
```

上記を起動用URLと呼びます。

起動用URLの後ろに開きたいURLを指定します。引数と呼びます。  
例:

```
http://localhost/Temporary_Listen_Addresses/openURL/https://www.yukiyukivirtual.net/?query=hoge  
```

- 引数の#以降は無視されます。未サポートです。


## 起動方法
パソコン起動時に、このアプリを常に起動しておくことをおすすめします。ショートカットをスタートアップに登録しておきましょう。  
初めて使うときのみ、下記の手順を実施してから、exeを実行します。次回以降は、パソコンを起動したときに自動的に起動されるようになります。

1. VRChatOpenBrowser.exeのショートカットを作成する。
2. Win+Rに「shell:startup」と打ち込む。
3. 開いたフォルダにショートカットを置く。
4. VRChatを起動して、SettingsからALLOW UNTRUSTED URLSを有効にする。

## メニュー
タスクトレイの雪アイコンから各種操作できます。

- ダブルクリックまたは、右クリック「フォルダを開く」で、「設定ファイル」、「実行ファイル」、「ログファイル」が格納されているフォルダを表示します。
- 右クリック「更新をチェックしに行く」で、配布ページを開きます。更新があるかチェックしてください。
- 右クリック「終了」で、このアプリを終了します。


## アプリの更新
更新があると、起動時に通知されます。下記手順で更新してください。設定ファイルのバックアップが必要であれば、各自で行ってください。
1. アプリを一旦終了させてください。
2. ダウンロードしたファイルを上書き保存してください。
3. exeを実行してください。ショートカットを登録しなおす必要はありません。

アプリ起動時（主にパソコン起動時）にバージョン確認があります。*メニュー* から確認してください。ファイルアップ作業中などで、最新版が配布されていない場合がありますが、翌日などに再度ご確認ください。

Boothで購入した場合は、Boothから最新版をダウンロードしてください。


## 設定について
設定ファイルは2種類あります。
- ユーザー設定： *user_setting.yaml* 
- デフォルト設定： *setting.yaml* 

ユーザー設定は自分でテキストファイルを作成してください。  
デフォルト設定は、アプリ起動時に常に最新ファイルで上書きされるので、変更・追加してほしい場合は、「問い合わせ」へお願いします。

### 休止期間 IdlePeriod
**デフォルト設定のみ有効**

VRChatでトリガーを連打しても、この期間（ミリ秒）は無視されます。  
この設定は、ユーザー設定から廃止しました。変更の要望は「問い合わせ」へお願いします。

### プロトコル Protocol
**デフォルト設定+ユーザー設定**

許可するプロトコルを指定します。デフォルトではhttpsのみ許可されています。  
httpや、その他のプロトコルを許可する場合は下記のような構文で追記してください。  
この設定は保存することで即座に有効になります。

```yaml
Protocol:
  - https
  - http
```

### ドメイン名 Domain
**デフォルト設定+ユーザー設定**

開くことが出来るドメイン名を指定します。  
サブドメインはこの設定に含まれます。（例：yukiyukivirtual.booth.pmはbooth.pmに含まれます）

ユーザー側で追加したい場合は下記のような構文で追記してください。
この設定は保存することで即座に有効になります。

```yaml
Domain:
  - yukiyukivirtual.net
  - booth.pm
```


## ログ
ファイル名：*VRChatOpenBrowser.log*  
プログラムの実行状態や、エラーの原因を知るために出力されます。  
もしファイルサイズが大きくなりすぎた場合は、削除しても動作に問題ありません。

## PCのセキュリティについて
このアプリをダウンロード、実行時に、セキュリティソフトによってブロックされることがありますが、免責を確認の上、各自で対応してください。

## 免責
このアプリを使用して発生したいかなる障害について、製作者は責任を負いません。


## 問い合わせ
https://discord.gg/9MwqEGvdTm
不具合報告、デフォルトで許可してほしいドメイン名はここに報告お願いします。ツールが動作を停止した場合は、ツールに表示されているログもください。ツイッターでも一応受け付けます。  
イベント等で利用する際は、ぜひ教えてください！拡散に協力したいです。


## 開発向け
コンパイルオプション `csc -t:winexe VRChatOpenBrowser.cs /win32icon:ice.ico /res:ice.ico -r:System.Net.Http.dll -define:B`
